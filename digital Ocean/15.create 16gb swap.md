Below is the **exact safe way** to create **16GB swap** on your Ubuntu 22.04 VPS.

Your disk has **104GB free**, so using 16GB swap is **fully safe**.

---

# ğŸš€ **Create 16GB Swap on Ubuntu**

### **1ï¸âƒ£ Turn off existing swap (if any)**

```bash
sudo swapoff -a
```

### **2ï¸âƒ£ Delete old swapfile (if exists)**

```bash
sudo rm -f /swapfile
```

---

# 2ï¸âƒ£ **Create a 16GB New Swap File**

```bash
sudo fallocate -l 16G /swapfile
```

If `fallocate` fails, use slow but safe alternative:

```bash
sudo dd if=/dev/zero of=/swapfile bs=1M count=16000
```

---

# 3ï¸âƒ£ **Set correct permissions**

(VERY important for security)

```bash
sudo chmod 600 /swapfile
```

---

# 4ï¸âƒ£ **Convert to swap**

```bash
sudo mkswap /swapfile
```

---

# 5ï¸âƒ£ **Enable swap**

```bash
sudo swapon /swapfile
```

---

# 6ï¸âƒ£ **Make swap permanent (after reboot)**

```bash
echo "/swapfile none swap sw 0 0" | sudo tee -a /etc/fstab
```

---

# ğŸ” **Verify Swap**

```bash
free -h
```

Expected output:

```
Swap: 16G
```

---

# âš¡ Optional Performance Optimization (Recommended)

Reduce swap aggressiveness:

```bash
echo "vm.swappiness=10" | sudo tee -a /etc/sysctl.conf
sudo sysctl -p
```

Linux default is 60 (too high).
10 is perfect for Kubernetes + JVM + Kafka.

---

# ğŸ‰ Done!

You now have:

âœ” 16GB emergency memory
âœ” No more pod OOMKilled
âœ” Kafka rebalance fully stable
âœ” JVM safe from crashes
âœ” Server can handle high traffic load

---

If you want next:

ğŸ‘‰ optimize JVM memory
ğŸ‘‰ tune HPA
ğŸ‘‰ tune Kafka memory
ğŸ‘‰ reduce pod RAM consumption

Just tell me **â€œOptimize memory for productionâ€**.
