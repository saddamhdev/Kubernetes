Here is your **fully formatted, professional GitHub README.md**
for your Kubernetes + Ingress + BT Panel + Subdomain setup.

You can copy/paste this directly into **README.md** in your GitHub repo.

---

# ğŸ“˜ Kubernetes + NGINX Ingress + BT Panel Reverse Proxy Setup

### For Subdomain: **`https://icsquiz.deepseahost.com`**

This guide explains how to:

* Install Kubernetes (K3s)
* Install NGINX Ingress Controller on custom ports
* Connect BT Panel Nginx reverse proxy to Kubernetes
* Configure a subdomain with HTTPS
* Deploy a test workload
* Access it via `icsquiz.deepseahost.com`

This documentation is the exact setup used in production.

---

# ğŸ§± 1. System Requirements

| Requirement   | Recommended               |
| ------------- | ------------------------- |
| OS            | Ubuntu 20.04 / 22.04      |
| RAM           | 2GB+                      |
| CPU           | 1+ Core                   |
| Domain        | `icsquiz.deepseahost.com` |
| Control Panel | BT Panel (aaPanel)        |
| Access        | Root SSH                  |

---

# ğŸš€ 2. Install Kubernetes (K3s) Without Traefik

Disable Traefik to avoid conflict with Nginx (80/443):

```bash
curl -sfL https://get.k3s.io | INSTALL_K3S_EXEC="--disable=traefik" sh -
```

Verify the cluster:

```bash
kubectl get nodes
kubectl get pods -A
```

---

# ğŸŒ 3. Install NGINX Ingress Controller

Apply the official Ingress controller manifest:

```bash
kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/main/deploy/static/provider/cloud/deploy.yaml
```

Check status:

```bash
kubectl get pods -n ingress-nginx
```

---

# ğŸ”€ 4. Replace Default Ingress Service with Custom Ports (8080/8443)

Default ingress uses 80/443 â†’ conflicts with BT Panel Nginx.
Delete default controller service:

```bash
kubectl delete svc ingress-nginx-controller -n ingress-nginx
```

Create custom service:

```yaml
# ingress-svc-custom.yaml
apiVersion: v1
kind: Service
metadata:
  name: ingress-nginx-controller
  namespace: ingress-nginx
spec:
  type: NodePort
  selector:
    app.kubernetes.io/component: controller
    app.kubernetes.io/instance: ingress-nginx
    app.kubernetes.io/name: ingress-nginx
  ports:
    - name: http
      port: 8080
      targetPort: http
      nodePort: 30080
    - name: https
      port: 8443
      targetPort: https
      nodePort: 30443
```

Apply:

```bash
kubectl apply -f ingress-svc-custom.yaml
```

Verify:

```bash
kubectl get svc -n ingress-nginx
```

Expected ports:

```
8080:30080/TCP
8443:30443/TCP
```

---

# ğŸŒ 5. Create Subdomain in BT Panel

1. Login to BT Panel
2. Go to **Website â†’ Add Site**
3. Add domain: **icsquiz.deepseahost.com**
4. Root: `/www/wwwroot/icsquiz.deepseahost.com`
5. Type: Pure static

BT Panel creates:

```
/www/server/panel/vhost/nginx/icsquiz.deepseahost.com.conf
```

---

# ğŸ” 6. Issue SSL for Subdomain

BT Panel â†’ Website â†’ `icsquiz.deepseahost.com` â†’ SSL

* Select **Letâ€™s Encrypt**
* Click **Issue Certificate**

Certificate files created:

```
/www/server/panel/vhost/cert/icsquiz.deepseahost.com/fullchain.pem
/www/server/panel/vhost/cert/icsquiz.deepseahost.com/privkey.pem
```

---

# ğŸ” 7. Reverse Proxy BT Panel Nginx â†’ Kubernetes Ingress

Edit subdomain config:

```bash
nano /www/server/panel/vhost/nginx/icsquiz.deepseahost.com.conf
```

Use this full config:

```nginx
server {
    listen 80;
    server_name icsquiz.deepseahost.com;
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name icsquiz.deepseahost.com;

    # SSL Certificates (Auto-generated by BT Panel)
    ssl_certificate /www/server/panel/vhost/cert/icsquiz.deepseahost.com/fullchain.pem;
    ssl_certificate_key /www/server/panel/vhost/cert/icsquiz.deepseahost.com/privkey.pem;

    # Reverse Proxy to Kubernetes Ingress
    location / {
        proxy_pass http://127.0.0.1:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    # Optional static directory
    root /www/wwwroot/icsquiz.deepseahost.com;
    index index.html;
}
```

Reload:

```bash
sudo /etc/init.d/nginx reload
```

---

# ğŸ§ª 8. Deploy Test Application in Kubernetes

Deploy NGINX inside Kubernetes:

```bash
kubectl create deployment demo --image=nginx
```

Expose it:

```bash
kubectl expose deployment demo --port=80
```

Verify:

```bash
kubectl get svc
```

---

# ğŸ“¥ 9. Create Ingress for Subdomain

Create file:

```bash
nano icsquiz-ingress.yaml
```

Paste:

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: icsquiz-ingress
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  ingressClassName: nginx
  rules:
    - host: icsquiz.deepseahost.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: demo
                port:
                  number: 80
```

Apply:

```bash
kubectl apply -f icsquiz-ingress.yaml
```

Verify:

```bash
kubectl get ingress -A
```

Expected:

```
HOSTS
icsquiz.deepseahost.com
```

---

# ğŸŒ 10. Test in Browser

Open:

```
https://icsquiz.deepseahost.com
```

You should see the NGINX welcome page served from Kubernetes.

---

# ğŸ§¾ 11. Final Architecture Diagram

```
User Browser
      â†“
HTTPS (443)
      â†“
BT Panel Nginx Reverse Proxy
 (icsquiz.deepseahost.com â†’ 127.0.0.1:8080)
      â†“
Ingress-NGINX (Kubernetes)
      â†“
ClusterIP Service (demo)
      â†“
Deployment (Nginx Container)
```

---

# ğŸ‰ 12. Success!

You now have:

âœ” Kubernetes cluster (K3s)
âœ” Custom-port ingress controller
âœ” BT Panel Nginx reverse proxy
âœ” Full HTTPS
âœ” Subdomain â†’ Kubernetes pipeline
âœ” Test application working

---

# ğŸ“Œ Want to add your real application?

If you want, I can generate:

* Deployment YAML
* Service YAML
* Ingress YAML
* Resource limits
* Horizontal Pod Autoscaler
* Redis / Kafka configs

Just open an issue or request:
â€œ**Add ICS Quiz App Deployment docs**â€

---

If you'd like, I can also:

âœ… Add GitHub badges
âœ… Add a table of contents
âœ… Add diagrams as PNG/SVG
âœ… Format this README with a logo

Just tell me!
